language: node_js
node_js:
  - 8
sudo:
  - required
addons:
  - apt:
    - sources: ['ubuntu-toolchain-r-test']
    - packages: ['cmake', 'nodejs', 'g++-5']
install:
  - cd ..
  - wget https://s3.amazonaws.com/mozilla-games/emscripten/releases/emsdk-portable.tar.gz
  - tar -xvf emsdk-portable.tar.gz
  - cd emsdk-portable
  - ./emsdk update
  - ./emsdk install latest
  - ./emsdk activate latest
  - cd ..
  - git clone --branch=$TRAVIS_BRANCH https://github.com/iotaeco/iota-pico-core.git iotaeco/iota-pico-core
  - cd iotaeco/iota-pico-core
  - npm link
  - cd ../../
  - git clone --branch=$TRAVIS_BRANCH https://github.com/iotaeco/iota-pico-data.git iotaeco/iota-pico-data
  - cd iotaeco/iota-pico-data
  - npm link @iota-pico/core
  - npm link
  - cd ../../
  - git clone --branch=$TRAVIS_BRANCH https://github.com/iotaeco/iota-pico-crypto.git iotaeco/iota-pico-crypto
  - cd iotaeco/iota-pico-crypto
  - npm link @iota-pico/core @iota-pico/data
  - npm link
  - cd ../iota-pico-pow-wasm
  - npm link @iota-pico/core @iota-pico/data @iota-pico/crypto
  - npm install
script:
  - npm run dist
cache:
  directories:
    - "node_modules"
    - "emsdk-portable"
